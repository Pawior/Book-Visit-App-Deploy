(this["webpackJsonpbook-visit-app"]=this["webpackJsonpbook-visit-app"]||[]).push([[0],{71:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(37),o=n.n(a),s=n(9),i=(n(71),n(1)),u=n.n(i),l=n(35),d=n(5),j=Object(r.createContext)(null),b=n(62),O=n(46),p=n(25),f={apiKey:"AIzaSyDzG340nqg5aAfp_9-7g6R3MZajtPXCvRU",authDomain:"book-visit-app.firebaseapp.com",databaseURL:"https://book-visit-app-default-rtdb.europe-west1.firebasedatabase.app",projectId:"book-visit-app",storageBucket:"book-visit-app.appspot.com",messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDzG340nqg5aAfp_9-7g6R3MZajtPXCvRU",REACT_APP_FIREBASE_APP_ID:"1:566914259425:web:57b5084311c2f89166daa0",REACT_APP_FIREBASE_AUTH_DOMAIN:"book-visit-app.firebaseapp.com",REACT_APP_FIREBASE_DATABEASE_URL:"https://book-visit-app-default-rtdb.europe-west1.firebasedatabase.app",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-ZRGZYSXZG4",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"566914259425",REACT_APP_FIREBASE_PROJECT_ID:"book-visit-app",REACT_APP_FIREBASE_STORAGE_BUCKET:"book-visit-app.appspot.com"}).REACT_APP_FIREBASE__MESSAGING_SENDER_ID,appId:"1:566914259425:web:57b5084311c2f89166daa0",measurementId:"G-ZRGZYSXZG4"},h=Object(b.a)(f),x=Object(O.f)(h),m=(Object(p.b)(h),n(14)),g=n(18),v=n(24),E=n(30),S=n(49),_=n(3),w=function(e){var t,n=Object(r.useContext)(j),c=n.user,a=(n.setUser,Object(r.useState)("")),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(g.g)(),d=["orange","royalblue","green"];t="pending"===e.status?d[0]:"in progress"===e.status?d[1]:d[2],Object(r.useEffect)((function(){var t;"number"==typeof e.date?(t=new Date(1e3*e.date).toString().substr(0,21),u(t)):(t=new Date(1e3*e.date.seconds).toString().substr(0,21),u(t))}),[]);return Object(_.jsxs)(v.a,{className:"mt-4 m-2",border:"primary",style:{width:"18rem"},children:[Object(_.jsxs)(v.a.Header,{children:["Zlecenie",Object(_.jsx)(S.a,{bg:"primary",style:{position:"absolute",top:"5px",right:"5px",backgroundColor:t,width:"5rem",height:"1.5rem"},children:e.status})]}),Object(_.jsxs)(v.a.Body,{children:[Object(_.jsx)(v.a.Title,{children:e.title}),Object(_.jsx)(v.a.Text,{children:i}),"allOrders"==e.type?Object(_.jsx)(E.a,{variant:"success",onClick:function(){return e.updateFunction(e.user,e.id)},children:"Accept order"}):Object(_.jsxs)(_.Fragment,{children:["worker"==c.userType?Object(_.jsx)(E.a,{variant:"danger",onClick:function(){return e.updateFunction(e.user,e.id)},children:"Decline"}):null,Object(_.jsx)(E.a,{className:"m-2",variant:"info",onClick:function(){return t=e,void l.push({pathname:"/order/".concat(t.id),state:{id:t.id,date:i,title:t.title,clientId:t.clientId,workerId:t.workerId,content:t.content,status:t.status}});var t},children:"Order info"})]})]})]},e.orderID)},k=(n(45),n(56),n(38)),I=function(){var e=Object(r.useContext)(j),t=e.user,n=e.setUser,c=localStorage.getItem("logged"),a=Object(r.useState)([]),o=Object(s.a)(a,2),i=o[0],b=o[1],O=Object(r.useState)(),p=Object(s.a)(O,2),f=p[0],h=p[1],v=Object(r.useState)(null),E=Object(s.a)(v,2),S=E[0],I=E[1],A=(Object(g.g)(),Object(m.b)(x,"orders"));Object(r.useEffect)((function(){n(JSON.parse(localStorage.getItem("user")))}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)(A);case 2:t=e.sent,b(t.docs.map((function(e){return Object(l.a)(Object(l.a)({},e.data()),{},{id:e.id})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var T=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(m.c)(x,"orders",n),c={workerId:t.id},e.next=4,Object(m.h)(r,c);case 4:window.location.reload(!1);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();if(c){var y=i.map((function(e){if(""==e.workerId){if(!f)return Object(_.jsx)(w,{title:e.name,content:e.description,clientId:e.clientId,workerId:e.workerId,date:e.date,status:e.status,updateFunction:T,user:t,type:"allOrders",id:e.id},e.id);if(e.date>=f/1e3&&S/1e3>=e.date)return console.log("co jest"),Object(_.jsx)(w,{title:e.name,content:e.description,clientId:e.clientId,workerId:e.workerId,date:e.date,status:e.status,updateFunction:T,user:t,type:"allOrders",id:e.id},e.id)}}));return Object(_.jsxs)("div",{children:[Object(_.jsx)(k.a,{initialSettings:{startDate:"10/1/2021",endDate:"10/31/2021"},onCallback:function(e,t,n){var r=new Date(e._d),c=new Date(t._d);console.log(r.getTime(),c.getTime()),h(r.getTime()),I(c.getTime())},children:Object(_.jsx)("button",{children:"Click Me To Open Picker!"})}),y]})}return Object(_.jsx)(g.a,{to:"/login"})},A=n(50),T=n(32),y=n(42);function C(){var e=Object(r.useContext)(j),t=e.user,n=e.setUser,c=Object(r.useState)(""),a=Object(s.a)(c,2),o=a[0],i=a[1],l=Object(r.useState)(""),b=Object(s.a)(l,2),O=b[0],p=b[1],f=Object(r.useState)(""),h=Object(s.a)(f,2),S=h[0],w=h[1],k=Object(r.useState)(!0),I=Object(s.a)(k,2),A=I[0],C=I[1],R=Object(r.useState)(3),P=Object(s.a)(R,2),D=P[0],N=P[1],B=Object(r.useState)(!1),F=Object(s.a)(B,2),M=F[0],U=F[1],G=Object(r.useState)(!1),L=Object(s.a)(G,2),H=(L[0],L[1]),J=Object(r.useRef)(!1),Z=Object(r.useRef)(),K=Object(r.useRef)(),z=Object(r.useRef)(),W=Object(g.g)(),q=Object(r.useState)(!1),Y=Object(s.a)(q,2),X=Y[0],V=(Y[1],Object(r.useState)()),Q=Object(s.a)(V,2),$=Q[0],ee=Q[1],te=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),document.querySelector(".login-info").innerHTML="",N(D-1),n=Object(m.f)(Object(m.b)(x,"".concat(z.current.value,"s")),Object(m.i)("email","==",Z.current.value),Object(m.i)("password","==",K.current.value)),e.next=6,Object(m.e)(n);case 6:return e.sent.forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t.id);case 2:return e.next=4,N(3);case 4:return e.next=6,C(!0);case 6:return e.next=8,p(t.data().email);case 8:return n=Object(m.c)(x,"".concat(z.current.value,"s"),t.id),r={loginAttemps:3,active:!0},e.next=12,Object(m.h)(n,r);case 12:return e.next=14,w(t.data().password);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=10,H(!0);case 10:return e.next=12,U(!0);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){ee(Z.current.value);["workers","clients"].forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(m.f)(Object(m.b)(x,t),Object(m.i)("email","==",Z.current.value)),e.next=3,Object(m.e)(n);case 3:e.sent.forEach(function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(m.c)(x,t,n.id),e.next=3,N(n.data().loginAttemps);case 3:return e.next=5,C(n.data().active);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};Object(r.useEffect)((function(){if(J.current){["workers","clients"].forEach(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(m.f)(Object(m.b)(x,t),Object(m.i)("email","==",Z.current.value)),e.next=3,Object(m.e)(n);case 3:e.sent.forEach(function(){var e=Object(d.a)(u.a.mark((function e(n){var r,c,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(m.c)(x,t,n.id),c={loginAttemps:D},e.next=4,Object(m.h)(r,c);case 4:if(!(n.data().loginAttemps<=0)){e.next=11;break}return a={active:!1},e.next=8,Object(m.h)(r,a);case 8:return o={loginAttemps:D},e.next=11,Object(m.h)(r,o);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),[D]);var re=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={email:t},fetch("http://localhost:5000/send-email",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),W.push({pathname:"/login"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!J.current||1!=A){e.next=6;break}return e.next=3,n({id:o,email:O,password:S,userType:z.current.value});case 3:N(3),e.next=7;break;case 6:J.current=!0;case 7:case"end":return e.stop()}}),e)}))),[S]),t&&1==A?Object(_.jsx)(g.a,{to:"/"}):0==A?Object(_.jsxs)(y.a.Dialog,{children:[Object(_.jsx)(y.a.Header,{children:Object(_.jsx)(y.a.Title,{children:"This account is not active"})}),Object(_.jsx)(y.a.Body,{children:Object(_.jsx)("p",{children:'Click "send activation email" and click activation link on our email or go back to login page.'})}),Object(_.jsxs)(y.a.Footer,{children:[Object(_.jsx)(E.a,{variant:"primary",onClick:function(){return re($)},children:"Send activation email"}),Object(_.jsx)(E.a,{variant:"danger",onClick:function(){W.push({pathname:"/login"}),window.location.reload()},children:"Go back to login"})]})]}):Object(_.jsx)("div",{children:Object(_.jsx)(v.a,{children:Object(_.jsxs)(v.a.Body,{children:[Object(_.jsx)("h2",{className:"text-center mb-4",children:"Log In"}),Object(_.jsxs)(T.a,{children:[Object(_.jsx)("h3",{children:"Log as"}),Object(_.jsxs)("select",{ref:z,children:[Object(_.jsx)("option",{children:"client"}),Object(_.jsx)("option",{children:"worker"})]}),Object(_.jsxs)(T.a.Group,{id:"email",children:[Object(_.jsx)(T.a.Label,{children:"Email"}),Object(_.jsx)(T.a.Control,{type:"email",ref:Z,required:!0,onBlur:function(){return ne()}})]}),Object(_.jsxs)(T.a.Group,{id:"password",children:[Object(_.jsx)(T.a.Label,{children:"Password"}),Object(_.jsx)(T.a.Control,{type:"password",ref:K,required:!0,onBlur:function(){return ne()}})]}),Object(_.jsx)("p",{className:"login-info"}),M?Object(_.jsxs)("div",{children:[" Wrong password or email! Left attemps: ",D]}):null,Object(_.jsx)(E.a,{disabled:X,className:"w-100 mt-4",type:"submit",onClick:te,required:!0,onBlur:function(){return ne()},children:"Login"})]})]})})})}var R=function(){return Object(_.jsx)("div",{children:Object(_.jsx)(A.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"60vh"},children:Object(_.jsx)("div",{className:"w-100",style:{maxWidth:"500px"},children:Object(_.jsx)(C,{children:" "})})})})},P=n(15),D=n(26),N=(n(83),function(){var e=Object(r.useContext)(j),t=e.user,n=e.setUser,c=Object(m.b)(x,"orders"),a=Object(r.useState)(""),o=Object(s.a)(a,2),i=o[0],l=o[1],b=Object(r.useState)(""),O=Object(s.a)(b,2),f=O[0],h=O[1],g=Object(r.useState)(""),v=Object(s.a)(g,2),S=v[0],w=v[1],k=Object(r.useState)(""),I=Object(s.a)(k,2),A=I[0],y=I[1],C=Object(r.useState)(!1),R=Object(s.a)(C,2),N=R[0],B=R[1],F=Object(r.useState)(""),M=Object(s.a)(F,2),U=(M[0],M[1],Object(r.useState)(0)),G=Object(s.a)(U,2),L=G[0],H=G[1],J=Object(r.useState)([]),Z=Object(s.a)(J,2),K=Z[0],z=Z[1],W=(Object(r.useRef)(null),Object(r.useRef)(null)),q=Object(r.useRef)(null),Y=Object(r.useRef)(null),X=Object(r.useRef)(null),V=Object(r.useRef)(null),Q=Object(p.b)();Object(r.useEffect)((function(){console.log(W)}),[W.current]),Object(r.useEffect)((function(){n(JSON.parse(localStorage.getItem("user")))}),[]);var $,ee=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t.target.files),H(Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,15)+Math.round(1e4*Math.random())),console.log(L),n=0;case 4:if(!(n<t.target.files.length)){e.next=10;break}return e.next=7,z([].concat(Object(D.a)(K),[t.target.files[n]]));case 7:n++,e.next=4;break;case 10:console.log(K);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){return i&&f&&A&&A?N?(document.querySelector(".form-errors").innerHTML="<span class='form-success'>Success!</span>",!1):(document.querySelector(".form-errors").innerHTML="<span class='form-error'>Confirm you are not a robot!</span>",!0):(console.log("Fields must be no empty"),document.querySelector(".form-errors").innerHTML="<span class='form-error'>Fields must not be empty!</span>",!0)},ne=function(){var e=Object(d.a)(u.a.mark((function e(n){var r,a,o,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,te();case 3:return e.next=5,te();case 5:if(!e.sent){e.next=12;break}r=new Date(S),a=r.getTime()/1e3,a-=7200,e.next=26;break;case 12:return console.log("success"),re(),o=A.substring(0,A.indexOf(":")),s=A.substring(A.indexOf(":")+1),o*=3600,s*=60,l=new Date(S),a=l.getTime()/1e3,a=(a-=7200)+o+s,e.next=24,void K.forEach((function(e){var t=Object(p.d)(Q,"images/".concat(L,"/").concat(e.name));Object(p.e)(t,e).then((function(e){console.log("file uploaded!")})).catch((function(e){return console.log(e)}))}));case 24:return e.next=26,Object(m.a)(c,{name:i,description:f,date:a,status:"pending",clientId:t.id,workerId:"",imagesId:L});case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={email:t.email,title:i,description:f,date:S,clientId:t.id},e.next=3,fetch("http://localhost:5000/confirmation-email",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}));case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsx)("div",{children:Object(_.jsxs)(T.a,{className:"m-2 addOrder mt-5",children:[Object(_.jsx)("h1",{className:"page-title display-3",children:Object(_.jsx)("strong",{children:"Add Order"})}),Object(_.jsx)("br",{}),Object(_.jsxs)(T.a.Group,{className:"mb-3",controlId:"formBasicTitle",children:[Object(_.jsx)(T.a.Label,{children:"Order title"}),Object(_.jsx)(T.a.Control,{ref:q,type:"text",placeholder:"Enter order title",className:"order-title",onChange:function(e){return l(e.target.value)}}),Object(_.jsx)(T.a.Text,{className:"text-muted",children:"Chose a wise one"})]}),Object(_.jsx)(T.a.Control,{ref:Y,type:"date",name:"date_of_visit",className:"order-date",onChange:function(e){return w(e.target.value)}}),Object(_.jsxs)("select",($={ref:X,className:"time-select"},Object(P.a)($,"className","order-time"),Object(P.a)($,"onChange",function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(t.target.value);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(P.a)($,"children",[Object(_.jsx)("option",{children:"Choose hour"}),Object(_.jsx)("option",{children:"8:00"}),Object(_.jsx)("option",{children:"9:00"}),Object(_.jsx)("option",{children:"10:00"}),Object(_.jsx)("option",{children:"11:00"}),Object(_.jsx)("option",{children:"12:00"}),Object(_.jsx)("option",{children:"13:00"}),Object(_.jsx)("option",{children:"14:00"}),Object(_.jsx)("option",{children:"15:00"}),Object(_.jsx)("option",{children:"16:00"}),Object(_.jsx)("option",{children:"17:00"})]),$)),Object(_.jsxs)(T.a.Group,{className:"mb-3",controlId:"formControlTextarea",children:[Object(_.jsx)(T.a.Label,{children:"Description"}),Object(_.jsx)(T.a.Control,{ref:V,as:"textarea",rows:3,className:"order-content",onChange:function(e){return h(e.target.value)}})]}),Object(_.jsx)(T.a.Group,{className:"mb-3",controlId:"formBasicCheckbox",children:Object(_.jsx)(T.a.Check,{type:"checkbox",label:"I am not a robot",onClick:function(){return B(!N)}})}),Object(_.jsx)("p",{className:"form-errors"}),Object(_.jsx)(E.a,{variant:"primary",onClick:ne,children:"Submit"}),Object(_.jsx)("input",{id:"upload-photo",type:"file",name:"upload-file",multiple:!0,ref:W,onChange:ee})]})})}),B=function(e){var t=Object(r.useContext)(j),n=t.user,c=t.setUser,a=Object(r.useState)([]),o=Object(s.a)(a,2),i=o[0],b=o[1],O=localStorage.getItem("logged"),p=Object(r.useState)(),f=Object(s.a)(p,2),h=f[0],v=f[1],E=Object(r.useState)(null),S=Object(s.a)(E,2),I=S[0],A=S[1],T=(Object(g.g)(),Object(m.b)(x,"orders"));Object(r.useEffect)((function(){c(JSON.parse(localStorage.getItem("user")))}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)(T);case 2:t=e.sent,b(t.docs.map((function(e){return Object(l.a)(Object(l.a)({},e.data()),{},{id:e.id})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),console.clear()}),[]);var y=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(m.c)(x,"orders",n),c={workerId:"",status:"pending"},e.next=4,Object(m.h)(r,c);case 4:window.location.reload();case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(e,t,n){console.log("start",e._d,"end",t,"label",n);var r=new Date(e._d),c=new Date(t._d);console.log(r.getTime(),c.getTime()),v(r.getTime()),A(c.getTime())};if(O){var R=0,P=i.map((function(t){if(t.workerId===e.location.state.workerId){if(!h)return R++,Object(_.jsx)(w,{title:t.name,content:t.description,clientId:t.clientId,workerId:t.workerId,date:t.date,status:t.status,user:n,id:t.id,updateFunction:y},t.id);if(t.date>=h/1e3&&I/1e3>=t.date)return R++,Object(_.jsx)(w,{title:t.name,content:t.description,clientId:t.clientId,workerId:t.workerId,date:t.date,status:t.status,user:n,id:t.id,updateFunction:y},t.id)}}));return console.log("orderList:",P),R?Object(_.jsxs)("div",{children:[Object(_.jsx)(k.a,{initialSettings:{startDate:"10/1/2021",endDate:"10/31/2021"},onCallback:C,children:Object(_.jsx)("button",{children:"Click Me To Open Picker!"})}),Object(_.jsxs)("div",{className:"d-flex",children:[Object(_.jsx)("div",{children:P.filter((function(e){return e?"pending"===e.props.status:null}))}),Object(_.jsx)("div",{children:P.filter((function(e){return e?"in progress"===e.props.status:null}))}),Object(_.jsx)("div",{children:P.filter((function(e){return e?"done"===e.props.status:null}))})]})]}):Object(_.jsxs)("div",{children:[Object(_.jsx)(k.a,{initialSettings:{startDate:"10/1/2021",endDate:"10/31/2021"},onCallback:C,children:Object(_.jsx)("button",{children:"Click Me To Open Picker!"})}),Object(_.jsx)("h2",{children:"All orders are done!"})]})}return Object(_.jsx)(g.a,{to:"/login"})},F=(n(84),n(10)),M=n(66),U=function(e){for(var t=Object(r.useRef)(),n=Object(r.useRef)(),c=Object(r.useRef)(),a=Object(r.useRef)(),o=(Object(m.b)(x,"freeTime"),Object(m.c)(x,"freeTime",e.workerId)),s=Object(m.c)(x,"orders",e.orderId),i=e.minHour,l=[],j=i=parseInt(i.substr(16,2));j<=17;j++)l.push("".concat(j,":00"));var b=l.map((function(e){return Object(_.jsx)("option",{value:e,children:e})})),O=function(e,t){for(var n={};;)if(t>45)n[e]=45,e++,t-=45;else{if(!(t<=45&&t>0))break;n[e]=t,t=0}return n},p=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)(o);case 2:return t=e.sent,e.abrupt("return",t.data());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(e,t,n){if(console.log(t),e.hasOwnProperty(n)){for(var r in e[n])if(t[n][r]){if(t[n][r]=t[n][r]+e[n][r],console.log(e[n][r]),console.log(t[n][r]),t[n][r]>45)return{};console.log("posiada"),!0}return t}return t},h=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return new Promise((function(t){return setTimeout(t,e)})).then((function(){console.log(t),Object(F.j)(t)?(console.log("nie mo\u017cna"),a.current.innerHTML="Nie mo\u017cesz zaakceptowa\u0107 tych opcji. Jeste\u015b wtedy zaj\u0119ty!"):(a.current.innerHTML="",console.log("mo\u017cna"),v(),Object(m.g)(o,t,{merge:!0}),setTimeout((function(){window.location.reload()}),500))}))},e.next=3,n(1e3);case 3:c.current.style.display="none";case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var r=Object(d.a)(u.a.mark((function r(){var a,o,s,i,l;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(c),c.current.style.display="block",a=O(parseInt(n.current.value),parseInt(t.current.value)),o=new Date(Date.parse(e.minHour)),s="".concat(o.getDate(),".").concat(o.getUTCMonth()+1,".").concat(o.getFullYear()),(i={})[s]=a,r.next=9,p();case 9:return l=r.sent,r.next=12,f(l,i,s);case 12:return i=r.sent,r.next=15,h(i);case 15:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={status:"in progress"},e.next=3,Object(m.h)(s,t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h5",{children:"Chose realization start hour: "}),Object(_.jsx)("select",{ref:n,children:b}),Object(_.jsx)("h5",{children:"Select how much time do you need to realize this order:"}),Object(_.jsxs)("select",{ref:t,className:"time-select",children:[Object(_.jsx)("option",{children:"5min"}),Object(_.jsx)("option",{children:"10min"}),Object(_.jsx)("option",{children:"15min"}),Object(_.jsx)("option",{children:"20min"}),Object(_.jsx)("option",{children:"25min"}),Object(_.jsx)("option",{children:"30min"}),Object(_.jsx)("option",{children:"35min"}),Object(_.jsx)("option",{children:"40min"}),Object(_.jsx)("option",{children:"50min"}),Object(_.jsx)("option",{children:"55min"}),Object(_.jsx)("option",{children:"60min"}),Object(_.jsx)("option",{children:"75min"}),Object(_.jsx)("option",{children:"90min"}),Object(_.jsx)("option",{children:"120min"}),Object(_.jsx)("option",{children:"150min"}),Object(_.jsx)("option",{children:"180min"}),Object(_.jsx)("option",{children:"240min"}),Object(_.jsx)("option",{children:"300min"}),"d"]}),Object(_.jsx)("br",{}),Object(_.jsx)("br",{}),Object(_.jsx)(E.a,{variant:"primary",onClick:function(){return g()},children:"Confirm time"}),Object(_.jsx)(M.a,{style:{display:"none"},ref:c,animation:"border",role:"status",children:Object(_.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),Object(_.jsx)("p",{className:"add-to-db-error",ref:a})]})},G=function(e){var t=Object(r.useContext)(j),n=t.user,c=t.setUser,a=Object(r.useState)("pending"),o=Object(s.a)(a,2),i=o[0],l=o[1],b=e.history.location.state,O=["orange","royalblue","green"],f=Object(r.useState)(""),h=Object(s.a)(f,2),g=h[0],w=h[1],k=Object(r.useState)(""),I=Object(s.a)(k,2),T=I[0],y=I[1],C=Object(r.useState)([]),R=Object(s.a)(C,2),P=R[0],N=R[1],B=Object(r.useState)([]),F=Object(s.a)(B,2),M=F[0],G=F[1],L=Object(p.b)();Object(r.useEffect)((function(){var e=Object(p.d)(L,"images/".concat(T));Object(p.c)(e).then((function(e){e.items.forEach((function(e){console.log(e.name),N([].concat(Object(D.a)(P),[e.name]))}))})).catch((function(e){console.log(e)})),console.log(P);var t=P.map((function(e){console.log("mapped images ");var t=Object(p.d)(L,"images/".concat(T,"/").concat(e));Object(p.a)(t).then((function(e){return console.log(e),Object(_.jsx)("img",{src:e})})).catch((function(e){console.log(e)}))}));console.log(t)}),[T]);var H=-1,J=M.map((function(e){console.log("mapped images "),console.log(e);Object(p.d)(L,"images/".concat(T,"/").concat(e));return H++,Object(_.jsx)("img",{src:e,className:"order-images",style:{left:"".concat(150*H,"px")}})}));Object(r.useEffect)((function(){P.forEach((function(e){var t=Object(p.d)(L,"images/".concat(T,"/").concat(e));Object(p.a)(t).then((function(e){console.log(e),G((function(t){return[e].concat(Object(D.a)(t))}))})).catch((function(e){console.log(e)}))})),console.log(M)}),[P]),Object(r.useEffect)((function(){console.log(M)}),[M]),Object(r.useEffect)(Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==i){e.next=4;break}w(O[0]),e.next=13;break;case 4:if("in progress"!==i){e.next=8;break}w(O[1]),e.next=13;break;case 8:return w(O[2]),t={email:n.email,title:b.title,description:b.content,date:b.date,clientId:n.id},e.next=12,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDzG340nqg5aAfp_9-7g6R3MZajtPXCvRU",REACT_APP_FIREBASE_APP_ID:"1:566914259425:web:57b5084311c2f89166daa0",REACT_APP_FIREBASE_AUTH_DOMAIN:"book-visit-app.firebaseapp.com",REACT_APP_FIREBASE_DATABEASE_URL:"https://book-visit-app-default-rtdb.europe-west1.firebasedatabase.app",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-ZRGZYSXZG4",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"566914259425",REACT_APP_FIREBASE_PROJECT_ID:"book-visit-app",REACT_APP_FIREBASE_STORAGE_BUCKET:"book-visit-app.appspot.com"}).NODE_SERVER_IP).concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDzG340nqg5aAfp_9-7g6R3MZajtPXCvRU",REACT_APP_FIREBASE_APP_ID:"1:566914259425:web:57b5084311c2f89166daa0",REACT_APP_FIREBASE_AUTH_DOMAIN:"book-visit-app.firebaseapp.com",REACT_APP_FIREBASE_DATABEASE_URL:"https://book-visit-app-default-rtdb.europe-west1.firebasedatabase.app",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-ZRGZYSXZG4",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"566914259425",REACT_APP_FIREBASE_PROJECT_ID:"book-visit-app",REACT_APP_FIREBASE_STORAGE_BUCKET:"book-visit-app.appspot.com"}).EMAIL_DONE),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}));case 12:e.sent;case 13:case"end":return e.stop()}}),e)}))),[i]),Object(r.useEffect)(Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.c)(x,"orders",b.id);case 2:return t=e.sent,e.next=5,Object(m.d)(t);case 5:n=e.sent,l(n.data().status),y(n.data().imagesId);case 8:case"end":return e.stop()}}),e)}))),[]),Object(r.useEffect)((function(){c(JSON.parse(localStorage.getItem("user")))}),[]);var Z=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.c)(x,"orders",b.id);case 2:return t=e.sent,e.next=5,Object(m.d)(t);case 5:return e.sent,n={status:"done"},b.status="done",l("done"),e.next=11,Object(m.h)(t,n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n?Object(_.jsx)("div",{id:"OrderDetailContainer",children:Object(_.jsx)(A.a,{className:"d-flex justify-content-center align-items-center h-100",children:Object(_.jsxs)(v.a,{border:"info",style:{width:"70rem",height:"35rem"},children:[Object(_.jsx)(v.a.Header,{className:"card-title",children:Object(_.jsx)(v.a.Title,{children:Object(_.jsxs)("h1",{children:[" ",b.title," "]})})}),Object(_.jsx)("h2",{children:"Description:"}),Object(_.jsxs)(v.a.Text,{children:[" ",b.content]}),Object(_.jsxs)(v.a.Body,{className:"d-flex car",children:[Object(_.jsx)(S.a,{className:"status-badge",bg:"primary",style:{position:"absolute",top:"10px",right:"50px",backgroundColor:g,width:"10rem",height:"2.5rem"},children:i}),n.userType?Object(_.jsxs)(_.Fragment,{children:["worker"===n.userType?Object(_.jsxs)(_.Fragment,{children:["pending"===i?Object(_.jsx)(U,{className:"m-0 align-self-end card-beggin",minHour:b.date,workerId:b.workerId,orderId:b.id}):null,"in progress"===i?Object(_.jsx)(E.a,{className:"align-self-center",style:{width:"230px",height:"50px"},variant:"success",onClick:function(){return Z()},children:" Done "}):null]}):null," "]}):null,J||null]})]})})}):null},L=function(e){var t=Object(r.useContext)(j),n=t.user,c=t.setUser,a=Object(r.useState)([]),o=Object(s.a)(a,2),i=o[0],b=o[1],O=Object(r.useState)(""),p=Object(s.a)(O,2),f=(p[0],p[1],localStorage.getItem("logged")),h=Object(r.useState)(),v=Object(s.a)(h,2),E=v[0],S=v[1],I=Object(r.useState)(null),A=Object(s.a)(I,2),T=A[0],y=A[1],C=(Object(g.g)(),Object(m.b)(x,"orders"));Object(r.useEffect)((function(){c(JSON.parse(localStorage.getItem("user")))}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)(C);case 2:t=e.sent,b(t.docs.map((function(e){return Object(l.a)(Object(l.a)({},e.data()),{},{id:e.id})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),console.clear()}),[]);var R=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(m.c)(x,"orders",n),c={workerId:"",status:"pending"},e.next=4,Object(m.h)(r,c);case 4:window.location.reload();case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),P=function(e,t,n){console.log("start",e._d,"end",t,"label",n);var r=new Date(e._d),c=new Date(t._d);console.log(r.getTime(),c.getTime()),S(r.getTime()),y(c.getTime())};if(f){var D=0,N=i.map((function(e){if(e.clientId===n.id){if(!E)return D++,Object(_.jsx)(w,{title:e.name,content:e.description,clientId:e.clientId,workerId:e.workerId,date:e.date,status:e.status,user:n,id:e.id,updateFunction:R},e.id);if(e.date>=E/1e3&&T/1e3>=e.date)return D++,Object(_.jsx)(w,{title:e.name,content:e.description,clientId:e.clientId,workerId:e.workerId,date:e.date,status:e.status,user:n,id:e.id,updateFunction:R},e.id)}}));return D?Object(_.jsxs)("div",{children:[Object(_.jsx)(k.a,{initialSettings:{startDate:"10/1/2021",endDate:"10/31/2021"},onCallback:P,children:Object(_.jsx)("button",{children:"Click Me To Open Picker!"})}),N]}):Object(_.jsxs)("div",{children:[Object(_.jsx)(k.a,{initialSettings:{startDate:"10/1/2021",endDate:"10/31/2021"},onCallback:P,children:Object(_.jsx)("button",{children:"Click Me To Open Picker!"})}),Object(_.jsx)("h2",{children:"You have not sended any orders!"})]})}return Object(_.jsx)(g.a,{to:"/login"})},H=function(){var e=Object(g.g)();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"Page not found!"}),Object(_.jsx)("button",{onClick:function(){e.push({pathname:"/"})},children:"Home page"})]})},J=(n(85),function(){var e,t=Object(r.useContext)(j),n=t.user,c=t.setUser,a=Object(g.g)();e=n?"worker"===n.userType?Object(_.jsxs)("ul",{children:[Object(_.jsx)("li",{children:Object(_.jsx)("a",{href:"/orders",children:"All orders"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{onClick:function(){return o()},href:"",children:"My orders"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{onClick:function(){return i()},href:"",children:"Logout"})})]}):Object(_.jsxs)("ul",{children:[Object(_.jsx)("li",{children:Object(_.jsx)("a",{href:"/addorder",children:"Add order"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{onClick:function(){return s()},href:"",children:"My orders"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{onClick:function(){return i()},href:"",children:"Logout"})})]}):Object(_.jsx)("h1",{children:"Welcome to Book Visit App"});var o=function(){a.push({pathname:"/myorders/".concat(n.id),state:{workerId:n.id}})},s=function(){a.push({pathname:"/user-orders/".concat(n.id),state:{clientId:n.id}})},i=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem("user",JSON.stringify({})),e.next=3,c({});case 3:window.location.reload(),a.push({pathname:"/login"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsx)("nav",{children:Object(_.jsxs)("div",{className:"nav-content",children:[e,Object(_.jsx)("img",{src:"/images/logo_transparent.png",onClick:function(){return a.push({pathname:"/"})}})]})})}),Z=n(29);function K(){var e=Object(r.useContext)(j),t=e.user,n=(e.setUser,Object(g.g)()),c=Object(r.useState)(!1),a=Object(s.a)(c,2);a[0],a[1];Object(r.useEffect)((function(){if(t){window.localStorage.setItem("logged",!0),window.localStorage.setItem("user",JSON.stringify({email:t.email,id:t.id,userType:t.userType}));var e=JSON.parse(localStorage.getItem("user"));window.localStorage.getItem("user");console.log(e),console.log(t)}}),[t]);return t?t.userType&&"client"==t.userType?(console.log("client"),Object(_.jsx)("div",{children:Object(_.jsx)("button",{onClick:function(){console.log(t.id),n.push({pathname:"/addorder"})},children:"Orders"})})):t.userType&&"worker"==t.userType?(console.log("worker"),Object(_.jsx)("div",{})):void 0:Object(_.jsx)(g.a,{to:"/login"})}var z=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(_.jsx)(Z.a,{children:Object(_.jsxs)(j.Provider,{value:{user:n,setUser:c},children:[Object(_.jsx)(J,{}),Object(_.jsxs)(g.d,{children:[Object(_.jsx)(g.b,{exact:!0,path:"/",component:K}),Object(_.jsx)(g.b,{path:"/login",component:R}),Object(_.jsx)(g.b,{path:"/orders",component:I}),Object(_.jsx)(g.b,{path:"/user-orders/:clientId",component:L}),Object(_.jsx)(g.b,{path:"/order/:orderId",component:G}),Object(_.jsx)(g.b,{path:"/myorders/:workerId",component:B}),Object(_.jsx)(g.b,{path:"/addorder",component:N}),Object(_.jsx)(g.b,{component:H})]})]})})};o.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(z,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.e793ac65.chunk.js.map